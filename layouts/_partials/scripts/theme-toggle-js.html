<script defer>
(function() {
  const THEME_KEY = 'theme';
  const DARK_CLASS = 'dark';
  const LIGHT_CLASS = 'light';
  
  // 切换主题
  function toggleTheme() {
    const html = document.documentElement;
    const isDark = html.classList.contains(DARK_CLASS);
    const newTheme = isDark ? 'light' : 'dark';
    localStorage.setItem(THEME_KEY, newTheme);
    html.classList.toggle(DARK_CLASS, !isDark);
    html.classList.toggle(LIGHT_CLASS, isDark);
  }
  
  // 绑定按钮事件
  document.addEventListener('DOMContentLoaded', function() {
    const toggleBtn = document.getElementById('theme-toggle');
    if (toggleBtn) toggleBtn.addEventListener('click', toggleTheme);
  });
  
  // 监听系统主题变化（仅当用户未手动设置时）
  window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
    if (!localStorage.getItem(THEME_KEY)) {
      const html = document.documentElement;
      html.classList.toggle(DARK_CLASS, e.matches);
      html.classList.toggle(LIGHT_CLASS, !e.matches);
    }
  });
})();
</script>
